{% extends "base.html" %}
{% load static %}
{% load video_tags %}
{% load resource_tags %}

{% block content %}
<!-- HERO SECTION -->
<header>
  {% include 'core/hero.html' %}
</header>

<main class="text-gray-800">

  <!-- Section: Latest Products (Top 4) -->
  <section id="latest-products" class="py-16 ">
    <div class="max-w-7xl mx-auto px-6 md:px-12">
      <h2 class="text-3xl md:text-4xl font-semibold text-teal-700 mb-10 text-center">
        Personal Growth Guides & Workbooks
      </h2>

      {% if latest_products %}
      <div class="grid gap-8 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4">
        {% for product in latest_products %}
        <div class="border border-slate-200 rounded-lg p-4 hover:shadow-lg transition duration-300 flex flex-col justify-between bg-white">
          <a href="{{ product.get_absolute_url }}">
            <figure class="mb-4 aspect-[3/4] flex items-center justify-center overflow-hidden rounded-md bg-white">
              {% if product.get_image_url %}
                <img src="{{ product.get_image_url }}" alt="{{ product.title }}" class="object-contain w-full h-full">
              {% else %}
                <img src="{% static 'images/placeholder.webp' %}" alt="Placeholder" class="object-contain w-full h-full">
              {% endif %}
            </figure>
            <h3 class="text-lg font-semibold text-teal-700 mb-2">{{ product.title }}</h3>
          </a>
          <div class="flex justify-between items-center mt-auto">
            <span class="text-lg font-semibold text-gray-700">
              ${{ product.current_price }}
            </span>
            <a href="{{ product.get_absolute_url }}"
               class="text-sm uppercase border border-teal-600 text-teal-600 px-3 py-1.5 rounded hover:bg-teal-600 hover:text-teal-800 transition">
              View
            </a>
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <p class="text-center text-gray-600">No latest products available at the moment.</p>
      {% endif %}
    </div>
  </section>

  <!-- Section: Featured Highlights -->
    {% include 'core/components/home-featured.html' %}

   <!-- Section: Cluster Pages Resource boxes -->
    {% include 'core/components/cluster-boxes.html' %}

     <!-- Section: Products by Category -->
    {% include 'core/components/category-products.html' %}
  
 <!-- Section: Journal Prompt Box -->
    {% include 'core/components/journalprompt.html' %}

    <!-- Latest Blog Posts Section -->
  <section class="w-full bg-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <a href="{% url 'news:list' %}" class="hover:text-teal-800">
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-semibold tracking-tight text-teal-700 mb-4 text-center">
      Personal Development Blog
      </h2>
      </a>
      <p class="text-gray-600 mb-8">Helpful tools, exercises, and prompts on building MORE! Momentum · Ownership · Resilience · Empowerment. Curated and edited by Diana Morgan.</p>
      {% if blog_posts %}
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          {% for post in blog_posts %}
            <div class="bg-white rounded-md mb-6 md:mb-0 shadow-sm overflow-hidden transition-transform duration-300 hover:shadow-lg hover:-translate-y-1">
              <a href="{{ post.get_absolute_url }}" class="block">
                <div class="h-48 overflow-hidden">
                  {% if post.image %}
                    <img src="{{ post.image.url }}" alt="{{ post.title }}" class="w-full h-full object-cover">
                  {% elif post.external_image_url %}
                    <img src="{{ post.external_image_url }}" alt="{{ post.title }}" class="w-full h-full object-cover">
                  {% elif post.youtube_url %}
                    {% with post.youtube_url|youtube_id as video_id %}
                      <img src="https://img.youtube.com/vi/{{ video_id }}/maxresdefault.jpg"
                          alt="{{ post.title }}"
                          class="w-full h-full object-cover"
                          onerror="this.onerror=null; this.src='https://img.youtube.com/vi/{{ video_id }}/hqdefault.jpg';">
                    {% endwith %}
                  {% endif %}
                </div>
                <div class="p-4">
                  <h3 class="text-lg font-bold text-gray-900 mb-2">{{ post.title }}</h3>
                  <p class="text-md text-gray-700 mb-3">{{ post.content|striptags|truncatewords:25 }}</p>
                  <span class="text-teal-700 hover:text-teal-700 text-sm font-medium">Read more →</span>
                </div>
              </a>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="text-center text-gray-500">No posts available yet.</p>
      {% endif %}
    </div>
  </section>

</main>

<script src="{% static 'js/category-filter.js' %}"></script>
{% endblock %}
